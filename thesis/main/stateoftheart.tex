\chapter{State of the Art}

\section{Introduction to Multimedia Forensics}

With the increasing spread of digital audio and video content, the analysis of these multimedia objects is rapidly assuming importance in the context of digital investigations, which consider both digital data and digital devices.

In digital investigations, multimedia content such as images, audio, and video are more and more being used as forensic evidence. It is therefore very important to be able to extract information from such content in a reliable manner.

Multimedia Forensics has the aim to gain knowledge on a multimedia content life cycle exploiting the traces that the various processing steps leave on the data. In fact, the idea behind Multimedia Forensics is that each acquisition device and each processing operation on a digital resource leave on the media content data some traces, often called fingerprints, which characterize its history.

Many algorithms and techniques have been developed by the scientific community based on the extraction of features from the stream of audio-visual data of the multimedia content. By taking advantage of these features, such techniques try to infer information about the source/acquisition device and about which encoding and editing processes the digital resource was subject to during its life cycle. Specifically for multimedia content such as images and videos, the main approaches set themselves the goal to identify the source of digital resource and/or to determine if the content is authentic or has been modify from its original without any a priori information about the content under analysis. This is possible using just these features and tools that allow to check for the presence or absence of such features or fingerprints that are intrinsically linked to the multimedia data by the acquisition device, the encoding step and any post-processing or editing software tools. In fact, we can distinguish three types of traces left on a multimedia content: acquisition traces, encoding traces, and editing traces.

As explained, from a scientific point of view, research has produced a large number of techniques for the analysis of multimedia content. From the point of view of the application of such techniques in the courtroom, however, there is an important gap that it is probably due to a lack of communication between the legal part and the scientific part, as well as a not complete maturity of the techniques that are often based on results obtained in laboratory contexts a not in real-world scenarios.

In addition, there is the need for greater sharing of standard in the field of digital multimedia forensics investigations that aid Multimedia Forensics to grow and reach maturity.

Several communities and groups have worked to put together guidelines and standard on important aspects of digital investigations, such as the chain of custody, data authentication, application of the scientific method, documentation, and reporting.
The ISO/IEC JTC1 Working Group 4 is one of those groups that seek to give international standards {LISTA} whose main purpose is to promote the best procedures and methods for the investigation of digital evidence. It also encourage the adoption of approaches for the forensic analysis on multimedia content that are shared at an international level, in order to ease the comparison and the combination of results from different entities and organizations and also through various jurisdictions, so as to increase the reliability of such methods and of the results.

Another group that aims at giving standards and guidelines for the digital investigations is the Scientific Working Group on Digital Evidence (SWGE) that deals with get in contact different organizations that work in the field of Multimedia Forensics in order to promote communication and cooperation and to ensure higher quality and consistency within the forensic community.

The Scientific Working Group on Imaging Technologies (SWGIT), instead, focuses his work on image analysis technology and has the aim to facilitate the integration of such methods of analysis of images in the context of the judicial system by providing best practices and guidelines for the acquisition, storage, processing, analysis, transmission, output image and archive of digital evidence.

Regarding the forensic analysis of images and/or videos, the process is defined to be composed of three main tasks: technical preparation, examination, interpretation. The technical preparation is concerned with all those operations necessary to prepare videos and images to the other tasks. The examination is the main part of the forensic analysis and deals with the application of techniques that aim to extract information from images/videos. The interpretation concerns the analysis of digital content from experts in order to provide conclusions on the features extracted from the images/videos under examination.

In this context, it becomes essential the figure of the Forensic Analyst, i.e. one who is able to develop and apply these methods for the analysis of digital content, interpret the results and make a summary of the results from different techniques in order to increase the reliability of the conclusions. It is also able to perform all of the analysis tasks in accordance with the standards shared by the forensic community. The Forensic Analyst is able to find the traces left on the multimedia data and to acquire information on the object under examination such as who is the source/acquisition device, whether the content is authentic and if the resource is intact, and so on.

\subsection{Applications}

{METTERE ESEMPI PRATICI}

The main applications for forensic analysis are: source identification, authentication, and integrity of the multimedia resource.

The source identification process has as objective the retrieval of information about the source device that generated the multimedia content under examination. It is possible to identify the source at various levels of detail. For example, sometimes it is possible to distinguish between types of sources, or to distinguish between different models of the same type of source, or to distinguish between different device that belong to the same type and model.

> Information can be obtained from metadata.

The authentication problem has to do with the task of determining whether the multimedia content is an accurate representation of an original event. The analysis process is typically base on finding inconsistency in the features extracted from the audio-visual signal.

The integrity problem concerns the task of determining whether a multimedia content has been changed or not from the moment that it has been created by the acquisition device. The analysis is based on the search for traces left by the editing tool or post-processing step during the life cycle that are not compatible with the source device that, for this application, is known.

\subsection{Tools}

{FRASE DUPLICATA DA INTRODUZIONE SUI METADATI}

A multimedia files can be viewed as a package composed of two main parts: the header, which contains the metadata, i.e. the information about the contents of the file; the content itself, i.e. the data stream which forms the audio-visual signal.
In general, the feature extraction is based on the analysis of traces left on both the actual data and the metadata of the multimedia file.

As for the inspection of the data stream, specifically for images and videos, the examination consists of two main aspects:
\begin{itemize}
\item interpretation of the content, which is the analysis of the context to understand what the data represents, who are the subjects and the objects involved, what is the environment. In general, the goal it to retrieve all the information that can be extrapolated from human observation.
\item identification of sensible details from the scene represented, such as audio-visual anomalies, the direction of the light, shadows, perspective inconsistencies, smudge marks, and so on.
\end{itemize}

Also in the context of the inspection of the audio-visual signal, a useful technique is to enhance the content, such as the improvement of the signal to detect relevant details or objects, the extraction of dimensional relationships between subjects and objects, the photographic comparison between known objects and objects represented in the scene.

The other tool regard the extraction and analysis of the metadata. Metadata can be easily extracted and can contain a lot of information regarding the data stream such as source device, color space, resolution, compression parameters, date, GPS coordinates, frame rate, format tags, bit rate, sample rate, number of channels. Obviously, the type and the number of metadata depends on the type of the file under examination and which processes has undergone during its life cycle. For example, concerning the images, metadata are typically extracted from the Image File Format header (Exif). Once the metadata is obtained it is the Forensic Analyst work to verify the compatibility, the completeness, and the consistency of this information with regards to the context in which it is known or assumed the resource come from. In fact, metadata might be different if a digital resource comes from a social network rather than directly from the acquisition device.

\section{Forensic Analysis of Video File Container}

{INTRODURRE GLOE}

\subsection{Video File Containers}

The forensic analysis has focused mainly its attention on the analysis of images developing techniques that used either the data stream, the metadata (such as Exif metadata), or both.

The forensic analysis of digital video is currently more and more relevant. Early work has followed procedures similar to the ones used for images, exploiting artefact and inconsistency in the data stream and/or examining the information extrapolated from the metadata.
However, regarding the use of metadata especially for the identification of digital sources, there are concerns over falsifiability. In fact, it is just a matter of finding the right software tools, often publicly available, to easily edit high-level information such as Exif metadata.

The video format standards prescribe only a limited number of features, thus leaving a lot of freedom to the manufacturer. This can be exploited by the Forensic Analyst as a resource, given a video, to identify the original source and to assess its authenticity and/or its integrity. In particular, the study will be focus on MP4-like video formats (MP4 and MOV).

In contrast, the known tools do not allow you to change the core structures of the media, such as the video file containers. So these low-level features reduce the concerns about the falsifiability of such metadata as only for a subject in possess of advanced programming skills will be able to modify the internal structure and content of video file containers. Even in this scenario, it would be still highly difficult to preserve consistency amongst all of the metadata, thus making the operation of falsifiability not trivial even for a highly technical figure.

The MOV container format was introduced by Apple in 1991. Using this format as a basis, they have also been introduced MP4 and 3GP formats.

The video file containers of this format are composed of atoms (or boxes) that are identified by a unique 4 bytes characters, preceded by the size of the atom. These atoms can have fields and can be nested, i.e. an atom may contain another atom. Thus, four types of atoms can be encounter:
\begin{itemize}
\item atoms without fields and that do not contain other atoms.
\item atoms without fields but that contain other atoms.
\item atoms with fields that do not contain other atoms.
\item atoms with fields that also contain other atoms.
\end{itemize}

The most common structure of the MP4-like containers is as follows:
\begin{itemize}
\item \emph{ftyp} atom: it is semi-mandatory, i.e. the latest ISO standards expect it to be present and to be explicit as soon as possible in the file container. It refers to the specific file types with which the video file, to which the container belongs, is compatible.
\item \emph{mdat} atom: it contains the data stream and specifies its size.
\item \emph{moov} atom: it is the atom with the most complex structure of the container. It is a nested atom which contains a number of other atoms. In this atom, and in its sub-structure, are contained the metadata needed for the decoding of the data stream contained in the \emph{mdat} atom.
\end{itemize}

This structure is not always respected. The file container of the MP4-like formats are very complex and have many elements and differences that depend on the source and on the manufacturing company; thus it can constitute a valuable tool for the Forensic Analysis.
The differences of containers across multiple types of video files can be found in many ways, as explained as follows:
\begin{itemize}
\item the relative position of the atoms: although the standard gives specifications about the location of specifics atoms (especially the main ones described above), these indications are not always respected. Above all, there is a change in position for those atoms whose position is not specified but the standard. This is true both at the first level of the container, that contains atoms such as \emph{ftyp}, \emph{mdata}, \emph{moov}, and both in terms of the atoms of the sub-structure contained in the \emph{moov} atom.
\item the presense of additional non-standard atoms at all level of the container.
\item differences in the fields values of the atoms.
\end{itemize}

All these possible differences and types of differences give rise to a large set of combinations that the Forensic Analyst can use to analyze a digital video resource.

{PARLARE ANCHE DEL FORMATO AVI}

\subsection{Applications for Video File Container}

The problem of the authentication is based on the analysis of the audio-visual signal in order to determine if the data is an actual represents of an original event. Thus, it is not in our domain because video file containers are treated as metadata. With metadata, you can not assess anything about the events represented in a video.

The integrity problem, instead, can be dealt with. As described above, the container of a video file is the container created by the last tool during the file life cycle. If a video is also slightly modified by software, it will have its own container. This container may contain additional atoms or change the positions and the fields values of the other atoms compared to the file container of the video before it was processed. Therefore, if the file container content and structure of an acquisition device is known, it is possible to compare the container of the query video file with the container of a reference video file (i.e. a video generated by the known or assumed acquisition device) in order to verify the integrity of the query video file, i.e. whether the file, during the time between its generation from the source device and the present, has been modified or not.

The problem of the source classification makes sense because, since the standards define only a few mandatory features for the file container, the manufacturing companies are left with a lot of freedom. This means that every class of device will have its own different container structure and values. This can be used to construct a set of features to distinguish between devices. For examples, in the case of video created by smartphones, it can be used to determine the belonging of a video to a brand, or to a specific brand and model, or to a specific brand, model, and operating system.
To do this, it is necessary to find a way to properly represent the various classes in a training set. In addition, there must be a compatibility measure that consider the likelihood of a query container to belong to a certain class of devices.

The proposed approach in this thesis will do just that, giving all the theory and the necessary information of how to implement a pipeline to solve the integrity and the source identification problem of a video file using the its file container.